(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{845:function(e,t,s){Promise.resolve().then(s.bind(s,3835))},3835:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(7437),a=s(2265),n=s(6463),l=s(5967);function i(e){let{onVerificationComplete:t}=e,[s,l]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[c,d]=(0,a.useState)("phone"),[u,m]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1);(0,n.useRouter)();let f=async e=>{e.preventDefault(),m(""),x(!0);try{let e=s;s.startsWith("+")||(e="+"+s);let t=await fetch("/api/verify/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:e})}),r=await t.json();r.success?d("code"):m(r.error||"Failed to send verification code")}catch(e){console.error("Error sending code:",e),m("Network error: Failed to send verification code")}finally{x(!1)}},p=async e=>{e.preventDefault(),m(""),x(!0);try{let e=s;s.startsWith("+")||(e="+"+s);let r=await fetch("/api/verify/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:e,code:i})}),a=await r.json();a.success&&a.valid?t():m(a.error||"Invalid verification code")}catch(e){console.error("Error verifying code:",e),m("Network error: Failed to verify code")}finally{x(!1)}};return(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-xl shadow-lg transform transition-all",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"phone"===c?"Verify Your Phone":"Enter Verification Code"}),(0,r.jsx)("div",{className:"h-1 w-24 bg-blue-600 mx-auto mb-6"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-8",children:"phone"===c?"Please enter your phone number to receive a verification code":"Enter the verification code sent to your phone"})]}),u&&(0,r.jsx)("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded-md",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"h-5 w-5 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,r.jsx)("p",{className:"text-sm text-red-700",children:u})]})}),"phone"===c?(0,r.jsxs)("form",{onSubmit:f,className:"mt-8 space-y-6",children:[(0,r.jsx)("div",{className:"rounded-md shadow-sm",children:(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{id:"phone",name:"phone",type:"tel",required:!0,className:"appearance-none rounded-lg relative block w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"+1234567890",value:s,onChange:e=>l(e.target.value),pattern:"^\\+?[1-9]\\d{1,14}$",title:"Please enter a valid phone number with country code (e.g., +1234567890)"}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,r.jsx)("span",{className:"text-gray-400",children:"\uD83D\uDCF1"})})]}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Include country code (e.g., +1 for US)"})]})}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Send Verification Code"})]}):(0,r.jsxs)("form",{onSubmit:p,className:"mt-8 space-y-6",children:[(0,r.jsx)("div",{className:"rounded-md shadow-sm",children:(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Code"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{id:"code",name:"code",type:"text",required:!0,className:"appearance-none rounded-lg relative block w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter 6-digit code",value:i,onChange:e=>o(e.target.value),maxLength:6,pattern:"\\d{6}"}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:(0,r.jsx)("span",{className:"text-gray-400",children:"\uD83D\uDD12"})})]})]})}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-semibold rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Verify Code"}),(0,r.jsx)("div",{className:"text-center mt-4",children:(0,r.jsx)("button",{type:"button",onClick:()=>d("phone"),className:"text-sm text-blue-600 hover:text-blue-500 font-medium transition-colors duration-200",children:"Change phone number"})})]})]})}function o(){let{user:e,error:t,isPhoneVerified:s,signInWithGoogle:o,setPhoneVerified:c}=(0,l.a)(),d=(0,n.useRouter)();return(0,a.useEffect)(()=>{e&&s&&d.push("/")},[e,s,d]),(0,r.jsxs)("div",{className:"min-h-screen flex",children:[(0,r.jsx)("div",{className:"hidden lg:flex lg:flex-1 bg-gradient-to-br from-blue-500 to-blue-700 justify-center items-center p-12",children:(0,r.jsxs)("div",{className:"max-w-md text-white",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"Welcome to Apka मित्र"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:"✨"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-1",children:"Personal Connection"}),(0,r.jsx)("p",{className:"text-blue-100",children:"Experience learning with a friend who understands you"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:"\uD83E\uDD1D"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-1",children:"Trusted Guide"}),(0,r.jsx)("p",{className:"text-blue-100",children:"Learn and grow with a companion who's always there for you"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-lg",children:"\uD83C\uDF1F"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-1",children:"Personalized Journey"}),(0,r.jsx)("p",{className:"text-blue-100",children:"Tailored guidance that adapts to your unique needs"})]})]})]})]})}),(0,r.jsx)("div",{className:"flex-1 flex flex-col justify-center items-center p-8 bg-gray-50",children:(0,r.jsx)("div",{className:"w-full max-w-md space-y-8",children:e&&!s?(0,r.jsx)(i,{onVerificationComplete:()=>{c(!0)}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Sign in to your account"}),(0,r.jsx)("div",{className:"h-1 w-24 bg-blue-600 mx-auto mb-6"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Get started with Google authentication"})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsxs)("button",{onClick:()=>o(),className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:[(0,r.jsx)("img",{className:"h-5 w-5 mr-2",src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google Logo"}),"Continue with Google"]})})]})})})]})}},5967:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return d},a:function(){return u}});var r=s(7437),a=s(2265),n=s(5186);let l=(0,s(5236).ZF)({apiKey:"AIzaSyABFhA56f4Jt4Zt5mWGCfUE-i8t0NG3ZQ0",authDomain:"apka-mitra.firebaseapp.com",projectId:"apka-mitra",storageBucket:"apka-mitra.firebasestorage.app",messagingSenderId:"858727056315",appId:"1:858727056315:web:c803f516b2cd365f8bba9e"}),i=(0,n.v0)(l);var o=s(6463);let c=(0,a.createContext)({user:null,loading:!0,error:null,isPhoneVerified:!1,signInWithGoogle:async()=>{},logout:async()=>{},setPhoneVerified:()=>{}});function d(e){let{children:t}=e,[s,l]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),p=(0,o.useRouter)();(0,a.useEffect)(()=>{let e=i.onAuthStateChanged(e=>{l(e),u(!1),e?document.cookie="auth=true; path=/":(document.cookie="auth=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",f(!1))});return()=>e()},[]);let g=async()=>{try{h(null);let e=new n.hJ;e.setCustomParameters({prompt:"select_account"}),(await (0,n.rh)(i,e)).user&&f(!1)}catch(e){console.error("Error signing in with Google:",e),h(e.message||"Failed to sign in with Google")}},b=async()=>{try{h(null),await (0,n.w7)(i),p.push("/login")}catch(e){console.error("Error signing out:",e),h(e.message||"Failed to sign out")}};return(0,r.jsx)(c.Provider,{value:{user:s,loading:d,error:m,isPhoneVerified:x,signInWithGoogle:g,logout:b,setPhoneVerified:e=>{f(e),e&&p.push("/")}},children:t})}let u=()=>(0,a.useContext)(c)}},function(e){e.O(0,[400,638,971,23,744],function(){return e(e.s=845)}),_N_E=e.O()}]);